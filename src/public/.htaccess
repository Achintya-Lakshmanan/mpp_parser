# Rewriting requests to the right endpoints
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Redirect localhost:3001 API calls to the origin
  RewriteCond %{HTTP_HOST} !^localhost
  RewriteRule ^localhost:3001/api/(.*)$ /api/$1 [R=307,L]
  
  # Redirect API calls to the backend
  RewriteRule ^api/(.*)$ %{REQUEST_SCHEME}://%{HTTP_HOST}/api/$1 [P,L]
  
  # Handle single page application routes
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^ index.html [QSA,L]
</IfModule>

# Set CORS headers
<IfModule mod_headers.c>
  Header set Access-Control-Allow-Origin "*"
  Header set Access-Control-Allow-Methods "GET, POST, OPTIONS, PUT, DELETE"
  Header set Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept"
</IfModule> 